---
title: "JavaScript objetos básicos y GEE"
subtitle: "Curso: Introducción al análisis espacial y web-mapping <br>con Google Earth Engine y R Shiny<br>"
author: "Mg. José A. Lastra <br>Matías Olea<br>"
institute: "Laboratorio Geo-Información y Percepción Remota"
date: "`r format(Sys.time(), '%d/%m/%Y')`"
output:
  xaringan::moon_reader:
    css: [fc]
    lib_dir: libs
    nature:
      highlightStyle: zenburn
      ratio: '16:9'
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "macros.js"

---
background-image: url(logo_labgrs_color.png)
background-position: center
background-size:40%

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

---
class: middle, center
## Introducción al Code Editor
<iframe width="800" height="500" src="https://www.youtube.com/embed/Khr31D_jP3w" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

---
# Recordando a Google Earth Engine

--
- Google Earth Engine (GEE) es una plataforma basada en la nube para el análisis geoespacial a escala planetaria que ofrece las capacidades computacionales masivas de Google permitiendo abordar una variedad de problemas sociales de alto impacto, incluyendo deforestación, sequía, desastres, enfermedades, seguridad alimentaria, gestión del agua, monitoreo del clima y protección del medio ambiente (Gorelick *et al.*, 2017)

--
- Nosotros haremos uso de la consola online que funciona en base a JavaScript.

--
- Lo primero será abrir el [(https://code.earthengine.google.com/)](https://code.earthengine.google.com/), conviene utilizar Google Chrome de preferencia ya que funciona mejor que en otros navegadores web.

--
- Usemos la consola

--
```{js}
print('Hola Mundo!');
```

--
- Podemos agregar comentarios usando *//*

---
# Tipos de datos

--
-**Strings**: Variables de tipo textos o cadenas de caracteres, se utilizan las comillas simples o dobles para definir una cadena.

```{js}
// Usamos comillas simples o dobles para crear un string
var saludoString = 'Hola Mundo!!';
print( saludoString );
```

- **Importante**: Tenga en cuenta que las variables se definen utilizando **var**


--
-**Números**: En las variables podemos almacenar números de distinta longitud y precisión.

```{js}
// Asignamos un número a una variable
var numero = 38;
print('El valor es:', numero);
```


--
- **Listas**: Las listas las definimos con corchetes [ ]. En GEE son útiles para realizar selecciones de elementos y podemos almacenar números, caracteres u otros elementos.

```{js}
// Lista de números
var listDeNumeros = [0, 1, 1, 2, 3, 5];
print('Lista de Números:', listDeNumeros);
// Lista de strings.
var listDeStrings = ['a', 'b', 'c', 'd'];
print('Lista de strings:', listDeStrings);
```

---

--
- **Objetos**: En JavaScript los objetos son diccionarios de pares **clave: valor**. Para crear un objeto (o diccionario) se utilizan las llaves **{ }**. Útil en procesos como creación de parámetros de visualización o exportación de elementos 

```{js}
// Usamos las llaves {} para hacer un diccionario de pares clave:valor
var object = {
  foo: 'bar',
  baz: 38,
  stuff: ['Algo', 'eso', 'otro más']
};
print('Diccionario:', object);

// Para acceder al valor de un diccionario se utiliza la clave y los corchetes [ ].
print('Imprime la clave foo:', object['foo']);
// También se puede acceder utilizando la notación con punto.
print('Print stuff:', object.stuff);
```

---

--
- **Funciones**: Las funciones son otra forma de mejorar la legibilidad y reutilización del código mediante el agrupamiento de operaciones.

--
- Una función se define mediante *function*.
- Los nombres de las funciones comienzan con una letra y tienen un par de paréntesis al final.
- Las funciones a menudo toman parámetros que le dicen a la función qué hacer. Estos parámetros van dentro de los paréntesis ().
- El conjunto de declaraciones que componen la función van dentro de las llaves { }. finalmente, return indica cuál es la salida de la función.

--
```{js}
// Ejemplo de cómo se define una función
var funcion_saludo = function( nombre ) {
  var mensaje = '¡Hola ' + nombre + '! ¿Cómo estas?';
  return mensaje;
};
// llamamos a la función con su parámetro.
print( funcion_saludo( 'José' ) );

```

---
# Objetos de GEE

--
- La forma de definir elementos en GEE tiene algunos contenedores específicos para ser enviados y utilizados en sus servidores.

--
- **Strings**: Para definir un string, tenemos que agregarlo al contenedor ee.String() y el contenedor será enviado a GEE.

```{js}
// Definimos un string y lo agregamos al contenedor
var unString = 'procesando';
var eeString = ee.String(unString);
print('Donde estabas? ', eeString);
```

---
- **Números**: Utilice ee.Number() para crear un objeto número en el servidor. Por ejemplo, utilice el método JavaScript Math.E para crear un valor de la constante en el servidor:

```{js}
// Definimos un número en el servidor
var serverNumber = ee.Number(Math.E);
print('e = ', serverNumber);
```

--
Los métodos *ee.String()* y *ee.Number()* son constructores, y por tanto, tienen argumentos (y posiblemente otros parámetros) que ponemos en un contenedor, y retornamos el contenedor y su contenido como un objeto EE que manipulamos en nuestro código. Un constructor comienza siempre con ee y retorna un objeto EE.

---
# Métodos en un objeto EE

--
- Para operar con un objeto de EE vamos a utilizar los métodos que son provistos según la clase de objeto con la que pretendemos trabajar. 


```{js}
// Utilice una función incorporada para realizar una operación en el número.
var logE = serverNumber.log();
print('log(e) = ', logE);
```


**Listas**: Podemos hacer una lista de JavaScript como un objeto ee.List en el servidor, ponemos un literal de JavaScript en un contenedor como con números y cadenas.

```{js}
// Ejemplos de listas, secuencia por extensión
var eeList = ee.List([1, 2, 3, 4, 5]);
// Secuencia usando el método del objeto list
var secuencia = ee.List.sequence(1, 5);
print('Secuencia:', secuencia);

```

---
Podemos recuperar un elemento de la lista con el operador *get()*. Recuerde que esta lista solo existe en el servidor, EE nos permite acceder a esos objetos solo a través de sus métodos.

--
```{js}
// Usamos un método de ee.List para recuperar un valor
var valor = secuencia.get(2);
print('Valor en la posición 2:', valor);

```

**Diccionarios**: Podemos crear un diccionario en Earth Engine a partir de un objeto JavaScript, de la misma manera que lo hicimos con String, Number y List. La función **ee.Dictionary** se construye desde un objeto JavaScript.

--
```{js}
// Crear un diccionario en el servidor
var diccionario = ee.Dictionary({
  e: Math.E,
  pi: Math.PI,
  phi: (1 + Math.sqrt(5)) / 2
});

// Recuperar algunos valores desde el diccionario.
print('Euler:', diccionario.get('e'));
print('Pi:', diccionario.get('pi'));
print('Golden ratio:', diccionario.get('phi'));

// Recuperar todas las claves
print('Claves: ', diccionario.keys());

```

---
**Fechas**: Los objetos de tipo **ee.Date** nos permiten representar tiempo. Al igual que con los otros tipos de datos, **NO** se debe confundir entre **Date** de JavaScript y el ee.Date de EE.

--
```{js}
// Definir una fecha en Earth Engine.
var fecha = ee.Date('2015-12-31');
print('Fecha:', fecha);

// Recuperar la fecha actual usando el método Date.now() de JavaScript.
var now = Date.now();
print('Milisegundos desde el 1 de Enero de 1970', now);

// Inicializar el objeto ee.Date
var eeNow = ee.Date(now);
print('Now:', eeNow);

```

Los objetos fechas son muy importantes para filtrar las colecciones, utilizando la función **filterDate()**.

---
background-image: url(logo_labgrs_color.png)
background-position: center
background-size:40%



